{"version":3,"sources":["../../../app-src/domain/negotiation/NegotiationService.js"],"names":["HttpService","Negotiation","NegotiationService","constructor","_http","getWeekNegotiations","get","then","negotiations","map","date","amount","value","Date","catch","err","ApplicationException","getPreviousWeekNegotiations","getFortnightNegotiations","getPeriodNegotiations","period","Promise","all","reduce","arr","item","concat","sort","a","b","getTime"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,iB,sBAAAA,W;;AACAC,iB,kBAAAA,W;;;AAEF,YAAMC,kBAAN,CAAyB;AAC9BC,sBAAc;AACZ,eAAKC,KAAL,GAAa,IAAIJ,WAAJ,EAAb;AACD;;AAEDK,8BAAsB;AACpB,iBAAO,KAAKD,KAAL,CACJE,GADI,CACA,mBADA,EAEJC,IAFI,CAECC,gBAAgBA,aACnBC,GADmB,CACf,CAAC,EAAEC,IAAF,EAAQC,MAAR,EAAgBC,KAAhB,EAAD,KAA6B,IAAIX,WAAJ,CAAgB,IAAIY,IAAJ,CAASH,IAAT,CAAhB,EAAgCC,MAAhC,EAAwCC,KAAxC,CADd,CAFjB,EAKJE,KALI,CAKEC,OAAO;AACZ,kBAAM,IAAIC,oBAAJ,CAAyB,6DAAzB,CAAN;AACD,WAPI,CAAP;AAQD;;AAEDC,sCAA8B;AAC5B,iBAAO,KAAKb,KAAL,CACJE,GADI,CACA,uBADA,EAEJC,IAFI,CAECC,gBAAgBA,aACnBC,GADmB,CACf,CAAC,EAAEC,IAAF,EAAQC,MAAR,EAAgBC,KAAhB,EAAD,KAA6B,IAAIX,WAAJ,CAAgB,IAAIY,IAAJ,CAASH,IAAT,CAAhB,EAAgCC,MAAhC,EAAwCC,KAAxC,CADd,CAFjB,EAKJE,KALI,CAKEC,OAAO;AACZ,kBAAM,IAAIC,oBAAJ,CAAyB,iEAAzB,CAAN;AACD,WAPI,CAAP;AAQD;;AAEDE,mCAA2B;AACzB,iBAAO,KAAKd,KAAL,CACJE,GADI,CACA,wBADA,EAEJC,IAFI,CAECC,gBAAgBA,aACnBC,GADmB,CACf,CAAC,EAAEC,IAAF,EAAQC,MAAR,EAAgBC,KAAhB,EAAD,KAA6B,IAAIX,WAAJ,CAAgB,IAAIY,IAAJ,CAASH,IAAT,CAAhB,EAAgCC,MAAhC,EAAwCC,KAAxC,CADd,CAFjB,EAKJE,KALI,CAKEC,OAAO;AACZ,kBAAM,IAAIC,oBAAJ,CAAyB,iEAAzB,CAAN;AACD,WAPI,CAAP;AAQD;;AAEKG,6BAAN,GAA8B;AAAA;;AAAA;AAC5B,gBAAI;AACF,oBAAMC,SAAS,MAAMC,QAAQC,GAAR,CAAY,CAC/B,MAAKjB,mBAAL,EAD+B,EAE/B,MAAKY,2BAAL,EAF+B,EAG/B,MAAKC,wBAAL,EAH+B,CAAZ,CAArB;;AAMA,qBAAOE,OACJG,MADI,CACG,UAACC,GAAD,EAAMC,IAAN;AAAA,uBAAeD,IAAIE,MAAJ,CAAWD,IAAX,CAAf;AAAA,eADH,EACoC,EADpC,EAEJE,IAFI,CAEC,UAACC,CAAD,EAAIC,CAAJ;AAAA,uBAAUD,EAAElB,IAAF,CAAOoB,OAAP,KAAmBD,EAAEnB,IAAF,CAAOoB,OAAP,EAA7B;AAAA,eAFD,CAAP;AAGD,aAVD,CAUE,OAAMf,GAAN,EAAW;AACX,oBAAM,IAAIC,oBAAJ,CAAyB,mEAAzB,CAAN;AACD;AAb2B;AAc7B;AApD6B","file":"NegotiationService.js","sourcesContent":["import { HttpService } from '../../util/HttpService.js';\r\nimport { Negotiation } from './Negotiation.js';\r\n\r\nexport class NegotiationService {\r\n  constructor() {\r\n    this._http = new HttpService();\r\n  }\r\n\r\n  getWeekNegotiations() {\r\n    return this._http\r\n      .get('negotiations/week')\r\n      .then(negotiations => negotiations\r\n        .map(({ date, amount, value }) => new Negotiation(new Date(date), amount, value))\r\n      )\r\n      .catch(err => {\r\n        throw new ApplicationException('An error occurred while fetching this week\\'s negotiations.')\r\n      });\r\n  }\r\n\r\n  getPreviousWeekNegotiations() {\r\n    return this._http\r\n      .get('negotiations/previous')\r\n      .then(negotiations => negotiations\r\n        .map(({ date, amount, value }) => new Negotiation(new Date(date), amount, value))\r\n      )\r\n      .catch(err => {\r\n        throw new ApplicationException('An error occurred while fetching previous week\\'s negotiations.')\r\n      });\r\n  }\r\n\r\n  getFortnightNegotiations() {\r\n    return this._http\r\n      .get('negotiations/fortnight')\r\n      .then(negotiations => negotiations\r\n        .map(({ date, amount, value }) => new Negotiation(new Date(date), amount, value))\r\n      )\r\n      .catch(err => {\r\n        throw new ApplicationException('An error occurred while fetching previous week\\'s negotiations.')\r\n      });\r\n  }\r\n\r\n  async getPeriodNegotiations() {\r\n    try {\r\n      const period = await Promise.all([\r\n        this.getWeekNegotiations(),\r\n        this.getPreviousWeekNegotiations(),\r\n        this.getFortnightNegotiations()\r\n      ]);\r\n\r\n      return period\r\n        .reduce((arr, item) => arr.concat(item), [])\r\n        .sort((a, b) => a.date.getTime() - b.date.getTime());\r\n    } catch(err) {\r\n      throw new ApplicationException('An error occurred while fetching the negotiations for the period.');\r\n    }\r\n  }\r\n}\r\n"]}